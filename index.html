<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Story → Video Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0; font-family:Arial,sans-serif;
  background:#0f172a; color:#fff; text-align:center;
  padding:20px;
}
h1{color:#38bdf8;}
textarea{
  width:100%; max-width:650px; height:150px;
  padding:15px; font-size:16px; border-radius:10px; border:none;
}
select,input{
  margin-top:12px; padding:10px; border-radius:8px; border:none;
}
button{
  margin-top:18px; padding:14px 28px;
  font-size:16px; border:none; border-radius:10px;
  background:#38bdf8; color:#000; font-weight:bold;
}
#status{margin-top:20px;font-size:16px;color:#facc15;}
#videoBox{display:none;margin-top:25px;}
video{width:100%;border-radius:10px;}
.info{margin-top:25px;font-size:14px;opacity:0.9;}
</style>
</head>

<body>

<h1>AI Story → Video Demo</h1>

<textarea id="story" placeholder="Type your story here..."></textarea>

<br>

<label>Voice Speed: </label>
<input type="range" id="speed" min="0.8" max="1.4" step="0.1" value="1">

<br>

<button id="generateBtn" onclick="generateVideo()">Generate Video</button>

<div id="status"></div>

<div id="videoBox">
  <video id="demoVideo" controls>
    <source src="sample.mp4" type="video/mp4">
  </video>
  <br>
  <button onclick="downloadDemo()">Download Video</button>
</div>

<div class="info">
• Daily limit: 10 videos / 24h<br>
• Max length: 30 minutes<br>
• Voice synced with video demo<br>
• No watermark (demo)
</div>

<script>
let count = localStorage.getItem("count") || 0;
let day = localStorage.getItem("day") || new Date().toDateString();
if(day !== new Date().toDateString()){
  count = 0;
  localStorage.setItem("day",new Date().toDateString());
  localStorage.setItem("count",0);
}

function generateVideo(){
  const story = document.getElementById("story").value.trim();
  const speed = document.getElementById("speed").value;
  if(story.length < 15){
    alert("Please type a longer story first");
    return;
  }
  if(count >= 10){
    alert("Daily limit reached");
    return;
  }
  const words = story.split(/\s+/).length;
  const mins = Math.ceil(words / 150);
  if(mins > 30){
    alert("Too long!");
    return;
  }

  count++;
  localStorage.setItem("count", count);

  document.getElementById("status").innerText = "⏳ Generating video...";
  document.getElementById("videoBox").style.display = "none";
  document.getElementById("generateBtn").disabled = true;

  setTimeout(() => {
    document.getElementById("status").innerText = "▶️ Video ready";
    document.getElementById("videoBox").style.display = "block";
    document.getElementById("generateBtn").disabled = false;

    playStoryWithVideo(story, speed);
  }, 6000);
}

function playStoryWithVideo(text, rate){
  const video = document.getElementById("demoVideo");
  const utter = new SpeechSynthesisUtterance(text);
  utter.rate = rate;

  video.currentTime = 0;
  video.play();

  video.onplay = () => {
    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
  };
  video.onpause = () => speechSynthesis.cancel();
  video.onended = () => speechSynthesis.cancel();
}

function downloadDemo(){
  alert("Demo only — backend required for real MP4.");
}
</script>

</body>
</html>